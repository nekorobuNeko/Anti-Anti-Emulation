マルウェアは基本的に仮想環境で解析されるため、マルウェアは自身が仮想環境にいると判断するとその機能を停止させるアンチエミュレーションという機能を備えている。このプログラムはマルウェアが仮想環境でない端末に侵入しても、仮想環境であると誤認させることで、マルウェアの自爆をさせることを目的としていました。WindowsにおけるマルウェアはWindows APIが使用されていることが多いため、そこに任意の処理を挿入することでそれを実現しました。
対象としたマルウェアが使用するWindows APIは
1. GetSystemInfo, _popen関数
   マルウェアはこれらの関数を使用し、CPUを数を基に仮想環境かどうかを判断している。
   現代のほとんどのパソコンはCPUのコア数が4つ以上のため、コアがそれ以下の時、仮想環境と判断している。
   DLLをwithdll.exeで挿入することでCPU数が１つであるという応答を返すことができる。

2. ファイル
   ファイル内を探索した際、仮想環境特有のファイルが存在したとき仮想環境と判断
3. GetComputerName関数
   仮想環境では単調な名前(“USER”, ”ANDY”など)つけられることが多いので、マルウェアはGetComputerName関数でコンピューター名を探索した際、そのような名前であれば仮想環境と判断している。
   DLLをwithdll.exeで挿入することでコンピューター名がUSERであるという応答を起こすようにする。
4. ディスクサイズ
   仮想環境ではディスクサイズが小さめに設定されていることが多いため(60Gb以下)、ディスクサイズを探索した際、60Gb以下であれば仮想環境と判断
5. レジストリ
   レジストリを探索した際、仮想環境特有のレジストリが存在したとき仮想環境と判断
6. 物理メモリ
   仮想環境では物理メモリが小さめに設定されていることが多いため (4Gb 以下), 物理メモリが4Gb以下なら仮想環境と判断 
7. MacAdress
   仮想環境では特有のMacAdressが設定されていることが多いため, 特有のMacAdressなら仮想環境と判断
8. アクティブウィンドウ
   解析に使用させる仮想環境ではアクティブウィンドウが常にデスクトップになっていることがあるため、アクティブウィンドウを探索した際、アクティブウィンドウが常にデスクトップで あると仮想環境と判断
9. プロセス
   仮想環境では特有のプロセスが常時動いていることがあるそのようなプロセスを検知したら仮想環境と判断

deem.pyは上記をpythonコードで書いたもの。
